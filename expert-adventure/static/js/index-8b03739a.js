import{g as F}from"./role-03104db1.js";import{a as h,u as j,b as q}from"./user-227a144f.js";import{m as x}from"./message-21a4cbe2.js";import{aX as A}from"./index-13eaa06f.js";import{q as K,r as d,U as N,a6 as r,t as y,v as $,L as t,E as a,J as i,u as T,x as f,K as W,F as X,$ as G,D as H}from"./runtime-core.esm-bundler-3932d34b.js";import"./index-fff9eaea.js";import"./vue-router-ff44b207.js";import"./index-65f2f33a.js";const M={class:"dialog-footer"},P={class:"dialog-footer"},ne=K({__name:"index",setup(Q){const g=d([]),z=N({pageSize:10,pageNum:1}),_=d([]),V=d([]),k=d(null),m=d(!1),p=d(!1),u=N({username:"",password:""}),v=async()=>{const{data:s}=await h(z);g.value=s.list.map(e=>{var n;const o=(n=e.roles)==null?void 0:n.map(b=>b.rolename);return{...e,roleName:o||[]}})||[]};v();const L=s=>{},R=async s=>{const e=JSON.parse(JSON.stringify(s));_.value=e.roles.map(n=>n.roleId),k.value=s.id;const{data:o}=await F();V.value=o,m.value=!0},B=async()=>{const{data:s,success:e}=await j({id:k.value,roles:_.value});e&&(x(s,{type:"success"}),m.value=!1,v())},S=s=>{},D=()=>{p.value=!0},I=async()=>{const{success:s}=await q({...u});s&&(x("操作成功!",{type:"success"}),p.value=!1,v())};return(s,e)=>{const o=r("el-button"),n=r("el-table-column"),b=r("el-table"),J=r("el-option"),O=r("el-select"),w=r("el-dialog"),U=r("el-input"),C=r("el-form-item"),E=r("el-form");return y(),$("div",null,[t(o,{onClick:D,size:"small",icon:T(A),style:{"margin-bottom":"10px"}},{default:a(()=>[i("新增用户")]),_:1},8,["icon"]),t(b,{data:g.value,border:"",style:{width:"100%"}},{default:a(()=>[t(n,{prop:"username",label:"用户名","min-width":"180"}),t(n,{prop:"password",label:"密码","min-width":"180"}),t(n,{prop:"roles",label:"角色","min-width":"180"},{default:a(({row:l})=>{var c;return[f("span",null,W((c=l.roleName)==null?void 0:c.join(",")),1)]}),_:1}),t(n,{fixed:"right",label:"操作",width:"300"},{default:a(({row:l})=>[t(o,{link:"",type:"primary",size:"small",onClick:c=>L(l)},{default:a(()=>[i("编辑用户")]),_:2},1032,["onClick"]),t(o,{link:"",type:"primary",size:"small",onClick:c=>R(l)},{default:a(()=>[i("修改角色")]),_:2},1032,["onClick"]),t(o,{link:"",type:"danger",size:"small",onClick:c=>S(l)},{default:a(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(w,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=l=>m.value=l),title:"修改用户角色",width:"30%"},{footer:a(()=>[f("span",M,[t(o,{onClick:e[1]||(e[1]=l=>m.value=!1)},{default:a(()=>[i("取消")]),_:1}),t(o,{type:"primary",onClick:B},{default:a(()=>[i(" 确定 ")]),_:1})])]),default:a(()=>[f("div",null,[t(O,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=l=>_.value=l),multiple:"",placeholder:"",style:{width:"240px"}},{default:a(()=>[(y(!0),$(X,null,G(V.value,l=>(y(),H(J,{key:l.roleId,label:l.rolename,value:l.roleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"]),t(w,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=l=>p.value=l),title:"新增用户",width:"30%"},{footer:a(()=>[f("span",P,[t(o,{onClick:e[5]||(e[5]=l=>p.value=!1)},{default:a(()=>[i("取消")]),_:1}),t(o,{type:"primary",onClick:I},{default:a(()=>[i(" 确定 ")]),_:1})])]),default:a(()=>[f("div",null,[t(E,{model:u,"label-width":"80px"},{default:a(()=>[t(C,{label:"用户名"},{default:a(()=>[t(U,{modelValue:u.username,"onUpdate:modelValue":e[3]||(e[3]=l=>u.username=l)},null,8,["modelValue"])]),_:1}),t(C,{label:"密码"},{default:a(()=>[t(U,{modelValue:u.password,"onUpdate:modelValue":e[4]||(e[4]=l=>u.password=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"])])}}});export{ne as default};
