import{ab as b,ae as le}from"./index-fff9eaea.js";import{aX as te,av as ae}from"./index-13eaa06f.js";import{u as oe}from"./hooks-8231013c.js";import{m as A}from"./message-21a4cbe2.js";import{q as K,r as i,U as D,a6 as u,t as q,v as P,L as e,E as t,J as _,u as z,x as m,z as ne,K as R,F as se,$ as re,D as ue,H as ie,ad as de}from"./runtime-core.esm-bundler-3932d34b.js";import"./vue-router-ff44b207.js";import"./index-65f2f33a.js";import"./index-3e3bf4ad.js";const ce=d=>b.request("post","/menu/getMenuCreate",{data:d}),pe=d=>b.request("post","/menu/updateMenu",{data:d}),me=d=>b.request("get","/menu/menuDetail",{params:d}),fe=d=>b.request("get","/menu/getMenuChildren",{params:d}),_e={class:"my-header"},ge=["id"],ye={class:"icon-box"},be={class:"sub-menu-icon"},ve={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"13px"}},ke={class:"dialog-footer"},he=K({name:"permissionPage"}),Ue=K({...he,setup(d){const F=i([]),L=i([]),g=i(!1),v=i(""),k=async()=>{const{data:n}=await le();L.value=n||[],n.length>0&&(F.value=M(n))},T=async(n,l,s)=>{const{data:r,success:C}=await fe({key:n.key});if(C){const x=M(r);s(x)}},E=()=>{},M=n=>n.map(s=>{var r;return s.hasChildren=((r=s.children)==null?void 0:r.length)>0,{...s,icon:s.meta.icon,title:s.meta.title,rank:s.meta.rank||0,hasChildren:s.hasChildren}});k();const h=i(!1),U=i(null),$=i("default"),B=i(),V=i(),N=i(),o=D({title:"",path:"",rank:"",icon:"",parentKey:"",key:"",component:"",showLine:!1,keepAlive:!1}),S=[{label:"material-symbols:menu-book-outline-rounded",value:"material-symbols:menu-book-outline-rounded"},{label:"bi:car-front",value:"bi:car-front"},{label:"bi:calendar4-range",value:"bi:calendar4-range"}],j=D({name:[{required:!0,message:"Please input Activity name",trigger:"blur"},{min:3,max:5,message:"Length should be 3 to 5",trigger:"blur"}],region:[{required:!0,message:"Please select Activity zone",trigger:"change"}],count:[{required:!0,message:"Please select Activity count",trigger:"change"}],date1:[{type:"date",required:!0,message:"Please pick a date",trigger:"change"}],date2:[{type:"date",required:!0,message:"Please pick a time",trigger:"change"}],type:[{type:"array",required:!0,message:"Please select at least one activity type",trigger:"change"}],resource:[{required:!0,message:"Please select activity resource",trigger:"change"}],desc:[{required:!0,message:"Please input activity form",trigger:"blur"}]}),O=async n=>{n&&await n.validate(async(l,s)=>{l&&(h.value?(await pe({id:U.value,...o,name:o.key})).success&&(A("操作成功!",{type:"success"}),y(),await k()):(await ce({...o,name:o.key})).success&&(A("操作成功!",{type:"success"}),y(),k()))})},H=n=>{n&&n.resetFields()},I=async n=>{B.value=n,h.value=!0;const{data:l,success:s}=await me({id:n.id});s&&(Object.keys(o).forEach(r=>{o[r]=l[r]}),U.value=n.id,v.value=n.title,g.value=!0)},J=n=>{},y=()=>{g.value=!1,h.value=!1,X()},X=()=>{const n={title:"",path:"",rank:"",icon:"",parentKey:"",key:"",component:"",showLine:!1,keepAlive:!1};Object.keys(o).forEach(l=>{o[l]=n[l]})},G=()=>{v.value="新增菜单",g.value=!0};return(n,l)=>{const s=u("el-button"),r=u("el-table-column"),C=u("el-table"),x=u("el-icon"),f=u("el-input"),c=u("el-col"),p=u("el-form-item"),Q=u("el-option"),W=u("el-select"),Y=u("el-form"),Z=u("el-dialog");return q(),P("div",null,[e(s,{onClick:G,size:"small",icon:z(te),style:{"margin-bottom":"10px"}},{default:t(()=>[_("新增菜单")]),_:1},8,["icon"]),e(C,{ref_key:"expandTable",ref:N,data:F.value,style:{width:"100%"},onExpandChange:E,"row-key":"id",border:"",lazy:"",load:T,"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:t(()=>[e(r,{prop:"title",label:"标题"}),e(r,{prop:"icon",label:"图标"}),e(r,{prop:"name",label:"组件标识"}),e(r,{prop:"path",label:"菜单路径"}),e(r,{prop:"component",label:"组件路径"}),e(r,{prop:"rank",label:"排序"}),e(r,{prop:"showLink",label:"是否显示"}),e(r,{prop:"keepAlive",label:"是否缓存"}),e(r,{fixed:"right",label:"操作",width:"120"},{default:t(({row:a})=>[e(s,{link:"",type:"primary",size:"small",onClick:w=>I(a)},{default:t(()=>[_("编辑")]),_:2},1032,["onClick"]),e(s,{link:"",type:"danger",size:"small",onClick:w=>J(a)},{default:t(()=>[_("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(Z,{onClose:y,modelValue:g.value,"onUpdate:modelValue":l[9]||(l[9]=a=>g.value=a),title:"Tips",width:"30%","show-close":!1},{header:t(({close:a,titleId:w,titleClass:ee})=>[m("div",_e,[m("h4",{id:w,class:ne(ee)},R(v.value),11,ge),e(x,{class:"el-icon--left",onClick:a},{default:t(()=>[e(z(ae))]),_:2},1032,["onClick"])])]),footer:t(()=>[m("span",ke,[e(s,{onClick:y},{default:t(()=>[_("取消")]),_:1}),e(s,{type:"primary",onClick:l[7]||(l[7]=a=>H(V.value))},{default:t(()=>[_(" 重置 ")]),_:1}),e(s,{type:"primary",onClick:l[8]||(l[8]=a=>O(V.value))},{default:t(()=>[_(" 确定 ")]),_:1})])]),default:t(()=>[m("div",null,[e(Y,{ref_key:"ruleFormRef",ref:V,model:o,rules:j,"label-width":"120px",class:"demo-ruleForm",size:$.value,"status-icon":""},{default:t(()=>[e(p,{label:"标题",prop:"title"},{default:t(()=>[e(c,{span:20},{default:t(()=>[e(f,{modelValue:o.title,"onUpdate:modelValue":l[0]||(l[0]=a=>o.title=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{label:"菜单路径",prop:"path"},{default:t(()=>[e(c,{span:20},{default:t(()=>[e(f,{modelValue:o.path,"onUpdate:modelValue":l[1]||(l[1]=a=>o.path=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{label:"父组件名",prop:"parentKey"},{default:t(()=>[e(c,{span:20},{default:t(()=>[e(f,{modelValue:o.parentKey,"onUpdate:modelValue":l[2]||(l[2]=a=>o.parentKey=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{label:"组件名",prop:"key"},{default:t(()=>[e(c,{span:20},{default:t(()=>[e(f,{modelValue:o.key,"onUpdate:modelValue":l[3]||(l[3]=a=>o.key=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{label:"组件路径",prop:"component"},{default:t(()=>[e(c,{span:20},{default:t(()=>[e(f,{modelValue:o.component,"onUpdate:modelValue":l[4]||(l[4]=a=>o.component=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{label:"排序",prop:"rank"},{default:t(()=>[e(c,{span:20},{default:t(()=>[e(f,{modelValue:o.rank,"onUpdate:modelValue":l[5]||(l[5]=a=>o.rank=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{label:"选择图标",prop:"icon"},{default:t(()=>[e(c,{span:20},{default:t(()=>[e(W,{modelValue:o.icon,"onUpdate:modelValue":l[6]||(l[6]=a=>o.icon=a),placeholder:"Select"},{default:t(()=>[(q(),P(se,null,re(S,a=>e(Q,{key:a.value,label:a.label,value:a.value},{default:t(()=>[m("div",ye,[m("div",be,[(q(),ue(ie(z(oe)(de(a.label)))))]),m("span",ve,R(a.value),1)])]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules","size"])])]),_:1},8,["modelValue"])])}}});export{Ue as default};
